Profiles: [ "basic", "all" ]

TaskDefinitions:
  - Name: wafw00f
    CommandTemplate: wafw00f.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - Name: grab_url_metadata
    CommandTemplate: grab-url-metadata.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint
    MonitorRules:
      Schedule: 0 0 * * *
      PreCondition: new List<string>{ "401", "403", "501", "502", "503", "504" }.Contains(Tags["Status"])
      PostCondition: newTags["Status"] != oldTags["Status"]
      NotificationTemplate: Endpoint {{Url}} changed status code from {{oldTags["Status"]}} to {{newTags["Status"]}}

  - Name: webanalyze
    CommandTemplate: webanalyze.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - Name: webcrawl
    CommandTemplate: webcrawl.sh {{Url}}
    Filter: HttpEndpoint.Path == "/" || Tags["Content-Type"].Contains("/html") || Tags["Content-Type"].Contains("/xhtml")
    Subject: HttpEndpoint

  - Name: cors_check
    CommandTemplate: check-cors.sh {{Url}}
    Subject: HttpEndpoint
    Filter: HttpEndpoint.Path == "/" || Tags["Content-Type"].Contains("/json") || Tags["Content-Type"].Contains("/xml")

  - Name: short_name_scanning
    CommandTemplate: shortname-check.sh {{Url}}
    Subject: HttpEndpoint
    Filter: Tags["Title"].Contains("Internet Information Services")|| Tags["Title"].Contains("IIS")||Tags["Server"].Contains("IIS")||Tags["Server"].Contains("Microsoft-HTTPAPI")

  - Name: short_name_scanning_srv
    CommandTemplate: shortname-check.sh {{Address}}
    Subject: NetworkSocket
    Filter: Tags["Version"].Contains("IIS") || Tags["Version"].Contains("Microsoft HTTPAPI")

  # - Name: screenshot
  #   CommandTemplate: screenshot.sh {{Url}}
  #   Filter: HttpEndpoint.Path == "/"
  #   Subject: HttpEndpoint

#   - Name: second_order_takeover
#     CommandTemplate: cloud_misconfig_scan.sh {{Url}}
#     Subject: HttpEndpoint
#     Filter: CloudServiceRepository.Instance.IsCloudService(HttpEndpoint)
#     MatchOutOfScope: true
