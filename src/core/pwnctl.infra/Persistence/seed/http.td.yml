Profiles: [ "all" ]

TaskDefinitions:
  - ShortName: get_all_urls
    CommandTemplate: get-all-urls.sh {{Url}}
    Subject: HttpEndpoint
    Filter: HttpEndpoint.Path == "/"

  - ShortName: dir_brute_common
    CommandTemplate: dir-brute.sh {{Url}} /opt/wordlists/common.txt
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: file_brute_config
    CommandTemplate: file-brute.sh {{Url}} /opt/wordlists/config.txt
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: wafw00f
    CommandTemplate: wafw00f.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: grab_url_metadata
    CommandTemplate: grab-url-metadata.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: webanalyze
    CommandTemplate: webanalyze.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: screenshot
    CommandTemplate: screenshot.sh {{Url}}
    Filter: HttpEndpoint.Path == "/"
    Subject: HttpEndpoint

  - ShortName: webcrawl
    CommandTemplate: webcrawl.sh '{{Url}}'
    Filter: HttpEndpoint.Path == "/" || Tags["Content-Type"].Contains("/html") || Tags["Content-Type"].Contains("/xhtml")
    Subject: HttpEndpoint

  - ShortName: link_finder
    CommandTemplate: link-finder.sh {{Url}}
    Filter: HttpEndpoint.Extension == "js" || HttpEndpoint.Extension == "jsm" || Tags["Content-Type"].Contains("/javascript")
    Subject: HttpEndpoint

  - ShortName: cors_check
    CommandTemplate: check-cors.sh {{Url}}
    Subject: HttpEndpoint
    Filter: HttpEndpoint.Path == "/" || Tags["Content-Type"].Contains("/json") || Tags["Content-Type"].Contains("/xml")

  - ShortName: shortname_scanning
    CommandTemplate: shortname-check.sh {{Url}}
    Subject: HttpEndpoint
    Filter: Tags["Title"].Contains("Internet Information Services")|| Tags["Title"].Contains("IIS")||Tags["Server"].Contains("IIS")||Tags["Server"].Contains("Microsoft-HTTPAPI")

  - ShortName: shortname_scanning_srv
    CommandTemplate: shortname-check.sh {{Address}}
    Subject: NetworkSocket
    Filter: Tags["Version"].Contains("IIS") || Tags["Version"].Contains("Microsoft HTTPAPI")

  - ShortName: second_order_takeover
    CommandTemplate: cloud_misconfig_scan.sh {{Url}}
    Subject: HttpEndpoint
    Filter: CloudServiceRepository.Instance.IsCloudService(HttpEndpoint)
    MatchOutOfScope: true